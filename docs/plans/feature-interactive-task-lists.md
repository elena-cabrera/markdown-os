# Feature Plan: Interactive Task Lists

**Status:** Draft
**Created:** 2026-02-15
**Author:** Claude (via feature-planner skill)

---

## Overview

Add interactive checkbox functionality to markdown task lists, allowing users to click checkboxes in Preview mode to toggle their completion state. Changes auto-save immediately and persist to the markdown file.

**Key Features:**
- Clickable checkboxes in Preview mode that toggle `[ ]` ↔ `[x]`
- Immediate auto-save on checkbox toggle
- Conflict detection and handling for concurrent edits
- Visual feedback for checked/unchecked states
- Works with nested task lists and complex list structures

**Includes:**
- CSS styling for task list checkboxes (light + dark themes)
- JavaScript event handlers for checkbox clicks
- Markdown source mapping to find and update checkbox syntax
- Integration with existing save and conflict resolution infrastructure

---

## User Story / Value Proposition

**Problem:**
Users cannot interact with task lists (`- [ ]` checkbox syntax) in the preview. To toggle a task's completion status, they must:
1. Switch to Edit mode
2. Find the specific line in the markdown source
3. Manually change `[ ]` to `[x]` or vice versa
4. Switch back to Preview mode

This is tedious and breaks the reading flow, especially for meeting notes, project checklists, and TODO tracking.

**Solution:**
Click any checkbox in Preview mode to instantly toggle its state. The change saves automatically and updates both the markdown file and the rendered preview.

**User Benefit:**
- **Frictionless TODO management** - check off tasks without leaving Preview mode
- **Faster workflow** - no mode switching or manual editing required
- **Better note-taking** - maintain reading flow while tracking progress
- **Familiar UX** - matches behavior from Notion, Obsidian, Typora, GitHub issues

**Use Cases:**
1. **Meeting notes** - Check off agenda items as they're discussed
2. **Project planning** - Track implementation tasks in a README or spec doc
3. **Daily TODOs** - Maintain a running task list in a markdown file
4. **Documentation** - Interactive checklists for setup guides, onboarding docs

---

## Current Behavior

### Markdown Rendering
- Marked.js is configured with `gfm: true` (GitHub Flavored Markdown)
- Task list syntax `- [ ]` and `- [x]` are parsed into HTML checkboxes:
  ```html
  <ul>
    <li><input type="checkbox" disabled> Unchecked task</li>
    <li><input type="checkbox" disabled checked> Checked task</li>
  </ul>
  ```
- Checkboxes are rendered as `disabled` and cannot be interacted with
- The checkbox HTML is generated by Marked.js's GFM extension

### Save Workflow
- **Auto-save** triggers 1 second after editor input stops (debounced in `editor.js`)
- **Manual save** happens when switching from Edit → Preview tab
- **Conflict detection** checks if file changed externally before saving
- Saves use `/api/save` endpoint with JSON payload `{content: string}`
- Server timestamps internal writes to distinguish from external changes

### Files Involved
- `markdown_os/static/js/markdown.js` - Markdown rendering with Marked.js
- `markdown_os/static/js/editor.js` - Save logic, conflict handling, mode switching
- `markdown_os/static/css/styles.css` - Styling (currently no task list specific styles)
- `markdown_os/server.py` - `/api/save` endpoint, file locking, WebSocket notifications

---

## Proposed Behavior

### User Experience Flow

**In Preview Mode:**
1. User clicks an unchecked checkbox `[ ]`
2. Checkbox immediately updates to checked state visually
3. Save status shows "Saving..." briefly
4. Markdown source updates from `- [ ]` to `- [x]`
5. File saves to disk automatically
6. Save status shows "Saved"
7. Preview re-renders to reflect the change

**If External Conflict Detected:**
1. User clicks a checkbox
2. System detects file was modified externally
3. Conflict modal appears with 3 options:
   - **Save My Changes** - Overwrite external changes with checkbox toggle
   - **Discard My Changes** - Reload from disk, lose checkbox toggle
   - **Cancel** - Keep editing, don't apply toggle
4. User chooses action

**In Edit Mode:**
- Checkboxes remain non-interactive (user edits raw markdown as usual)
- Task list syntax is typed manually: `- [ ]` or `- [x]`

---

## Implementation Plan

### 1. Enable Checkbox Interactivity in Preview

**File:** `markdown_os/static/js/markdown.js`

**Changes:**
- Add new function `makeTaskListsInteractive()` after line 264
- Call this function from `renderMarkdown()` after TOC generation
- Function should:
  - Query all checkboxes in preview: `#markdown-preview input[type="checkbox"]`
  - Remove `disabled` attribute to make them clickable
  - Add click event listener to each checkbox
  - Store reference to parent `<li>` element for source mapping

**Code Location:** After line 264 (after TOC generation)

**Example Code:**
```javascript
function makeTaskListsInteractive() {
  const preview = document.getElementById("markdown-preview");
  if (!preview) {
    return;
  }

  const checkboxes = preview.querySelectorAll('input[type="checkbox"]');
  checkboxes.forEach((checkbox, index) => {
    // Remove disabled attribute to make clickable
    checkbox.removeAttribute("disabled");

    // Store checkbox index for source mapping
    checkbox.dataset.taskIndex = index;

    // Add click handler
    checkbox.addEventListener("click", async (event) => {
      event.preventDefault(); // Prevent default toggle
      await handleCheckboxToggle(checkbox);
    });
  });
}
```

**Rationale:**
Marked.js renders checkboxes as disabled by default. We need to enable them and attach click handlers. Using a checkbox index simplifies mapping to source lines.

---

### 2. Implement Checkbox Toggle Handler

**File:** `markdown_os/static/js/markdown.js`

**Changes:**
- Add `handleCheckboxToggle(checkbox)` function
- This function should:
  1. Get checkbox index from `dataset.taskIndex`
  2. Get current markdown content from editor textarea
  3. Find the Nth checkbox in markdown source using regex
  4. Toggle `[ ]` ↔ `[x]` in the source
  5. Update editor textarea value
  6. Trigger immediate save
  7. Re-render preview after save completes

**Code Location:** After `makeTaskListsInteractive()` function

**Example Code:**
```javascript
async function handleCheckboxToggle(checkbox) {
  const editor = document.getElementById("markdown-editor");
  if (!editor) {
    console.error("Editor not found for checkbox toggle");
    return;
  }

  const taskIndex = parseInt(checkbox.dataset.taskIndex, 10);
  const content = editor.value;

  // Find all task list items in markdown
  // Matches: "- [ ]" or "- [x]" (with optional leading whitespace)
  const taskRegex = /^(\s*[-*+]\s+\[)([ x])(\])/gm;
  let match;
  let matchCount = 0;
  let newContent = content;

  while ((match = taskRegex.exec(content)) !== null) {
    if (matchCount === taskIndex) {
      // Toggle the checkbox state
      const currentState = match[2];
      const newState = currentState === "x" ? " " : "x";

      // Replace this specific checkbox
      const before = content.substring(0, match.index);
      const after = content.substring(match.index + match[0].length);
      const replacement = `${match[1]}${newState}${match[3]}`;
      newContent = before + replacement + after;
      break;
    }
    matchCount++;
  }

  if (newContent === content) {
    console.error("Failed to find checkbox in markdown source");
    return;
  }

  // Update editor content
  editor.value = newContent;

  // Check for conflicts before saving
  if (window.checkForExternalChanges) {
    const hasConflict = await window.checkForExternalChanges();
    if (hasConflict) {
      // Show conflict modal
      if (window.showConflictDialog) {
        const choice = await window.showConflictDialog();
        if (choice === "save") {
          await window.saveContent();
        } else if (choice === "discard") {
          await window.loadContent();
          return; // Don't re-render
        } else {
          // Cancel - revert editor and checkbox
          editor.value = content;
          checkbox.checked = !checkbox.checked;
          return;
        }
      }
    } else {
      // No conflict, save immediately
      await window.saveContent();
    }
  }

  // Re-render preview to show updated state
  await window.renderMarkdown(editor.value);
}
```

**Rationale:**
Using regex with a counter allows us to find the Nth checkbox in order, which matches the DOM order. This handles nested lists and complex structures correctly. We reuse the existing conflict detection and save infrastructure.

---

### 3. Expose Helper Functions for Checkbox Module

**File:** `markdown_os/static/js/editor.js`

**Changes:**
- Expose `checkForExternalChanges`, `showConflictDialog`, `saveContent`, and `loadContent` on `window` object
- These are currently private functions but need to be callable from `markdown.js`

**Code Location:**
- Line 72: `async function checkForExternalChanges()`
- Line 88: `async function showConflictDialog()`
- Line 203: `async function saveContent()`
- Line 46: `async function loadContent()`

**Changes:**
```javascript
// After function declarations, expose them globally
window.checkForExternalChanges = checkForExternalChanges;
window.showConflictDialog = showConflictDialog;
window.saveContent = saveContent;
window.loadContent = loadContent;
```

**Rationale:**
The checkbox toggle logic in `markdown.js` needs to access save and conflict functions from `editor.js`. Exposing them on `window` is the simplest cross-module communication pattern in the current architecture.

---

### 4. Add CSS Styling for Interactive Checkboxes

**File:** `markdown_os/static/css/styles.css`

**Changes:**
- Add task list checkbox styles for both light and dark themes
- Style checked/unchecked states
- Add hover effects
- Ensure checkboxes are visually distinct from regular text

**Code Location:** After line 450 (after `.mermaid-error` styles)

**Example Code:**
```css
/* Task list checkbox styling */
#markdown-preview ul {
  list-style: none;
  padding-left: 0;
}

#markdown-preview ul li {
  position: relative;
  padding-left: 1.8em;
  margin: 0.4em 0;
}

#markdown-preview input[type="checkbox"] {
  position: absolute;
  left: 0;
  top: 0.25em;
  width: 18px;
  height: 18px;
  cursor: pointer;
  border: 2px solid var(--border);
  border-radius: 4px;
  background: var(--panel-bg);
  appearance: none;
  -webkit-appearance: none;
  -moz-appearance: none;
  transition: all 0.15s ease;
}

#markdown-preview input[type="checkbox"]:hover {
  border-color: var(--accent);
  background: var(--accent-soft);
}

#markdown-preview input[type="checkbox"]:checked {
  border-color: var(--accent);
  background: var(--accent);
}

#markdown-preview input[type="checkbox"]:checked::after {
  content: "";
  position: absolute;
  left: 5px;
  top: 2px;
  width: 4px;
  height: 8px;
  border: solid white;
  border-width: 0 2px 2px 0;
  transform: rotate(45deg);
}

/* Nested task lists */
#markdown-preview ul ul {
  padding-left: 1.8em;
  margin-top: 0.2em;
}
```

**Rationale:**
Custom checkbox styling provides a modern, polished appearance consistent with the existing design system. The checkmark animation uses a CSS border trick for the ✓ symbol, avoiding icon dependencies.

---

### 5. Update Markdown Rendering Pipeline

**File:** `markdown_os/static/js/markdown.js`

**Changes:**
- Call `makeTaskListsInteractive()` in `renderMarkdown()` function
- Ensure it runs after all other rendering (Mermaid, code blocks, TOC)

**Code Location:** Line 264 (inside `renderMarkdown()` function)

**Before:**
```javascript
if (window.generateTOC) {
  window.generateTOC();
}
```

**After:**
```javascript
if (window.generateTOC) {
  window.generateTOC();
}

makeTaskListsInteractive();
```

**Rationale:**
Task list interactivity should be set up after all rendering is complete. This ensures checkboxes exist in the DOM before we query and modify them.

---

### 6. Handle Re-rendering Edge Cases

**File:** `markdown_os/static/js/markdown.js`

**Changes:**
- Ensure `makeTaskListsInteractive()` is idempotent (can be called multiple times safely)
- Remove duplicate event listeners when re-rendering
- Consider using event delegation instead of per-checkbox listeners for better performance

**Code Location:** `makeTaskListsInteractive()` function

**Enhanced Implementation:**
```javascript
function makeTaskListsInteractive() {
  const preview = document.getElementById("markdown-preview");
  if (!preview) {
    return;
  }

  // Remove any existing delegated listener
  if (preview._taskListClickHandler) {
    preview.removeEventListener("click", preview._taskListClickHandler);
  }

  // Use event delegation for better performance
  const clickHandler = async (event) => {
    const checkbox = event.target;
    if (checkbox.type !== "checkbox") {
      return;
    }

    event.preventDefault();
    await handleCheckboxToggle(checkbox);
  };

  preview.addEventListener("click", clickHandler);
  preview._taskListClickHandler = clickHandler;

  // Enable all checkboxes and add indices
  const checkboxes = preview.querySelectorAll('input[type="checkbox"]');
  checkboxes.forEach((checkbox, index) => {
    checkbox.removeAttribute("disabled");
    checkbox.dataset.taskIndex = index;
  });
}
```

**Rationale:**
Event delegation is more efficient than attaching listeners to every checkbox individually. Storing the handler reference allows cleanup on re-render, preventing memory leaks.

---

## Files to Modify

| File | Changes |
|------|---------|
| `markdown_os/static/js/markdown.js` | • Add `makeTaskListsInteractive()` function<br>• Add `handleCheckboxToggle()` function<br>• Call interactivity setup in `renderMarkdown()`<br>• Use event delegation for click handling |
| `markdown_os/static/js/editor.js` | • Expose `checkForExternalChanges` on window<br>• Expose `showConflictDialog` on window<br>• Expose `saveContent` on window<br>• Expose `loadContent` on window |
| `markdown_os/static/css/styles.css` | • Add task list checkbox styles<br>• Style checked/unchecked states<br>• Add hover effects<br>• Support nested lists |

---

## Decisions / Open Questions

### Q1: Should we preserve checkbox focus state after re-render? ✅

**Options:**
- **Option A**: Re-render loses focus (simpler, current behavior for all elements)
- **Option B**: Store and restore focus to the toggled checkbox after render

**Decision:** Option A selected - Simpler implementation for MVP. Focus loss is acceptable since the checkbox toggle is a deliberate action that completes immediately. Users can refocus naturally if needed.

### Q2: How should we handle rapid successive toggles? ✅

**Options:**
- **Option A**: Queue toggles sequentially (complex, overkill for typical usage)
- **Option B**: Disable checkboxes while save is in progress (prevents race conditions)
- **Option C**: Optimistic UI updates, let conflicts resolve naturally

**Decision:** Option C selected - The existing conflict detection handles concurrent modifications. Optimistic updates provide better UX. If a user rapidly clicks multiple checkboxes, each toggle updates the editor content and triggers save. The last save wins, and external changes trigger the conflict modal.

### Q3: Should Edit mode also have interactive checkboxes? ✅

**Options:**
- **Option A**: Preview mode only (per user requirements)
- **Option B**: Both modes (more complex, requires special textarea handling)

**Decision:** Option A selected - User requirement specifies Preview mode only. Edit mode shows raw markdown for precise editing. This matches the read-first workflow: Preview for consumption/interaction, Edit for authoring.

### Q4: What about checkboxes inside blockquotes or code blocks? ✅

**Options:**
- **Option A**: Make all checkboxes interactive regardless of context
- **Option B**: Only enable checkboxes in list contexts (more precise)

**Decision:** Option A selected - Marked.js only generates checkbox HTML for proper task list syntax. Checkboxes in code blocks render as plain text, and blockquoted task lists are valid use cases. Our click handler only affects `<input type="checkbox">` elements, which only exist for task lists.

---

## Edge Cases

### Case 1: Checkbox in nested list
- **Scenario:** User has nested task lists with different indentation levels
- **Expected behavior:** Each checkbox toggles independently, maintaining nesting structure
- **Implementation note:** Regex matches leading whitespace (`^\s*`) and preserves it. Index-based matching ensures correct checkbox is targeted.

### Case 2: Multiple checkboxes on same line (invalid syntax)
- **Scenario:** User manually types `- [ ] Task 1 [ ] Task 2` (not standard markdown)
- **Expected behavior:** Marked.js only renders the first checkbox as HTML. Our handler only affects rendered checkboxes.
- **Implementation note:** No special handling needed - we rely on Marked.js parsing

### Case 3: External file change during checkbox toggle
- **Scenario:** User clicks checkbox while another process modifies the file
- **Expected behavior:** Conflict modal appears with 3 options (Save/Discard/Cancel)
- **Implementation note:** Reuse existing `checkForExternalChanges()` and `showConflictDialog()` logic from `editor.js`

### Case 4: Network/save failure
- **Scenario:** `/api/save` endpoint returns error (disk full, permissions issue)
- **Expected behavior:** Save status shows "Save failed". Checkbox reverts visually. User can retry.
- **Implementation note:** `saveContent()` already handles failures. We should add rollback logic:
  ```javascript
  const saveSuccess = await window.saveContent();
  if (!saveSuccess) {
    editor.value = content; // Revert content
    checkbox.checked = !checkbox.checked; // Revert checkbox
    return;
  }
  ```

### Case 5: Checkbox toggle in Edit mode
- **Scenario:** User switches to Edit mode and manually changes `[ ]` to `[x]` in the textarea
- **Expected behavior:** Normal editing flow. Auto-save triggers after 1s. Preview updates when switching back.
- **Implementation note:** No special handling needed - standard editor behavior

### Case 6: Very large document with 100+ checkboxes
- **Scenario:** Performance concerns with many checkboxes
- **Expected behavior:** Smooth interaction without lag
- **Implementation note:** Event delegation (single listener on preview container) scales well. Regex matching is O(n) but fast for typical documents. For extreme cases (1000+ checkboxes), consider optimizations like caching regex matches.

### Case 7: User clicks checkbox rapidly before save completes
- **Scenario:** User clicks same checkbox twice in quick succession
- **Expected behavior:** Each click toggles state. Final state reflects last click.
- **Implementation note:** `saveContent()` sets `editorState.isSaving` flag and returns early if already saving. The second click will be queued. This is acceptable behavior.

### Case 8: Checkbox rendering after theme change
- **Scenario:** User toggles dark/light theme
- **Expected behavior:** Checkbox styles update to match new theme (colors, borders)
- **Implementation note:** CSS variables automatically update all checkbox colors on theme change. No JavaScript needed.

---

## Testing Strategy

### Manual Testing Checklist

#### Basic Functionality
1. Open a markdown file with task list syntax → checkboxes should render as clickable
2. Click an unchecked checkbox `[ ]` → should change to checked `[x]` in source and preview
3. Click a checked checkbox `[x]` → should change to unchecked `[ ]` in source and preview
4. Check file on disk → should contain updated checkbox syntax
5. Reload page → checkbox states should persist

#### Save & Conflict Handling
6. Click checkbox → "Saving..." status should appear briefly
7. Click checkbox → "Saved" status should appear after save completes
8. Click checkbox while network is down → "Save failed" should appear
9. Modify file externally, then click checkbox → conflict modal should appear
10. In conflict modal, click "Save My Changes" → checkbox change should persist
11. In conflict modal, click "Discard My Changes" → checkbox change should revert
12. In conflict modal, click "Cancel" → checkbox should revert, editing continues

#### Edge Cases
13. Create nested task lists → each checkbox should toggle independently
14. Mix checked and unchecked items → each should toggle correctly
15. Add checkbox in blockquote → should be interactive
16. Click checkbox rapidly 5 times → should toggle each time without errors
17. Toggle theme while viewing checkboxes → styling should update smoothly
18. Create 50 checkboxes → interaction should remain responsive

#### Cross-mode Behavior
19. Click checkbox in Preview, switch to Edit → source should show updated syntax
20. Edit checkbox syntax manually in Edit, switch to Preview → checkbox state should update
21. Make checkbox changes in Edit without saving, external change occurs → conflict modal should work

### Automated Testing

**Unit Tests** (if adding test coverage):
- Test `findNthCheckbox(content, index)` regex logic with various markdown structures
- Test checkbox state toggle logic (`[ ]` ↔ `[x]`)
- Mock `saveContent()` and verify it's called on checkbox click

**Integration Tests:**
- Test full click → update → save → re-render flow
- Test conflict detection during checkbox toggle
- Test that event listeners are properly cleaned up on re-render

**End-to-End Tests** (optional):
- Use Playwright/Cypress to automate checkbox clicking in browser
- Verify file contents on disk after toggles
- Test external file modification scenarios

---

## Implementation Checklist

### Phase 1: Core Functionality
- [ ] Create `makeTaskListsInteractive()` function in `markdown.js`
  - [ ] Query all checkboxes in preview
  - [ ] Remove `disabled` attribute
  - [ ] Add task index to `dataset`
  - [ ] Set up event delegation for clicks
- [ ] Create `handleCheckboxToggle()` function in `markdown.js`
  - [ ] Get checkbox index
  - [ ] Find Nth checkbox in markdown source using regex
  - [ ] Toggle checkbox state in source
  - [ ] Update editor textarea value
- [ ] Integrate with save flow
  - [ ] Call `checkForExternalChanges()` before saving
  - [ ] Show conflict modal if needed
  - [ ] Call `saveContent()` on successful toggle
  - [ ] Re-render preview after save
- [ ] Expose helper functions in `editor.js`
  - [ ] Export `checkForExternalChanges` to window
  - [ ] Export `showConflictDialog` to window
  - [ ] Export `saveContent` to window
  - [ ] Export `loadContent` to window

### Phase 2: Styling & Polish
- [ ] Add checkbox CSS styles to `styles.css`
  - [ ] Base checkbox appearance (border, size, radius)
  - [ ] Hover state styling
  - [ ] Checked state styling
  - [ ] Checkmark icon (CSS-based)
  - [ ] Light theme variables
  - [ ] Dark theme variables
- [ ] Test visual appearance in both themes
- [ ] Adjust spacing/alignment if needed

### Phase 3: Edge Case Handling
- [ ] Handle save failures gracefully
  - [ ] Revert editor content on save error
  - [ ] Revert checkbox visual state on save error
- [ ] Optimize re-rendering
  - [ ] Ensure event listeners don't accumulate
  - [ ] Test with large documents (50+ checkboxes)
- [ ] Test nested task lists
- [ ] Test rapid clicking scenarios

### Phase 4: Testing & Documentation
- [ ] Manual testing against checklist above
- [ ] Test in both light and dark themes
- [ ] Test conflict resolution flows
- [ ] Test with external file changes (using another editor)
- [ ] Update README or CHANGELOG with new feature
- [ ] Consider adding user-facing documentation

---

## Success Criteria

### Core Functionality
✅ Checkboxes in Preview mode are clickable and toggle state
✅ Checkbox clicks update markdown source (`[ ]` ↔ `[x]`)
✅ Changes save immediately to disk without manual intervention
✅ File reloads preserve checkbox states correctly

### User Experience
✅ Visual feedback is immediate (no noticeable lag)
✅ Save status indicator updates appropriately
✅ Checkbox styling matches design system (light + dark themes)
✅ Hover effects provide clear affordance for interactivity

### Reliability
✅ Conflict detection works correctly during checkbox toggles
✅ External file changes trigger appropriate conflict modal
✅ Save failures show error messages and don't corrupt data
✅ Rapid clicking doesn't cause race conditions or errors

### Edge Cases
✅ Nested task lists work correctly
✅ Large documents (50+ checkboxes) remain responsive
✅ Theme switching doesn't break checkbox appearance
✅ WebSocket reconnection preserves checkbox functionality

### Code Quality
✅ Implementation follows existing code patterns
✅ No memory leaks from event listeners
✅ Functions are modular and reusable
✅ Code is documented with clear comments

---

## Timeline Estimate

**Total Effort:** ~4-6 hours for a solo developer

- **Phase 1 (Core):** 2-3 hours
- **Phase 2 (Styling):** 1 hour
- **Phase 3 (Edge Cases):** 1-1.5 hours
- **Phase 4 (Testing):** 0.5-1 hour

This is a **Low Effort** task suitable for a single development session. Most complexity is in mapping DOM checkboxes to markdown source positions, which is solved via indexed regex matching.

---

## Future Enhancements

These are explicitly out of scope for the MVP but could be considered later:

1. **Keyboard navigation** - Tab to focus checkboxes, Space/Enter to toggle
2. **Bulk toggle** - Select multiple checkboxes and toggle all at once
3. **Checkbox progress indicator** - Show "3/10 tasks completed" above task lists
4. **Checkbox history** - Track when tasks were completed (timestamps)
5. **Interactive in Edit mode** - Special handling to toggle in textarea (complex)
6. **Custom checkbox styles** - User-configurable colors/shapes
7. **Task list templates** - Quick-insert common task list structures
8. **Drag-to-reorder** - Reorder tasks by dragging checkboxes

---

## References

### Similar Implementations
- **Obsidian** - Click checkboxes in preview, updates source file
- **Typora** - WYSIWYG editor with live checkbox toggling
- **GitHub** - Interactive checkboxes in issue comments and markdown files
- **VS Code Markdown Preview** - Disabled checkboxes (view-only)

### Technical Resources
- Marked.js GFM extension: https://marked.js.org/using_advanced#options
- Task list spec: https://github.github.com/gfm/#task-list-items-extension-
- CSS checkbox styling: https://moderncss.dev/pure-css-custom-checkbox-style/

### Codebase References
- Existing save flow: `editor.js` lines 203-236
- Conflict detection: `editor.js` lines 72-86
- Markdown rendering: `markdown.js` lines 251-265
- Theme system: `theme.js` (CSS variable approach)